[tox]
skipsdist = true
envlist =
    spouse,
    intro,
    spam,
    scene_graph,
    crowdsourcing,
    mtl,
    multitask,
    drybell,
    style,

[testenv]
description = test/sync for {envname}
deps =
    -rrequirements.txt
    spouse: -rspouse/requirements.txt
    intro: -rintro/requirements.txt
    spam: -rspam/requirements.txt
    multitask: -rmultitask/requirements.txt
    scene_graph: -rscene_graph/requirements.txt
    crowdsourcing: -rcrowdsourcing/requirements.txt
    recsys: -rrecsys/requirements.txt
    drybell: -rdrybell/requirements.txt
passenv = JAVA_HOME
commands_pre = 
    drybell: python -m spacy download en_core_web_sm
# Available posargs: test, sync, html
commands =
    spouse: python {toxinidir}/scripts/build.py {posargs:test} spouse
    intro: python {toxinidir}/scripts/build.py {posargs:test} intro
    spam: python {toxinidir}/scripts/build.py {posargs:test} spam
    multitask: python {toxinidir}/scripts/build.py {posargs:test} multitask
    scene_graph: python {toxinidir}/scripts/build.py {posargs:test} scene_graph
    crowdsourcing: python {toxinidir}/scripts/build.py {posargs:test} crowdsourcing
    drybell: python {toxinidir}/scripts/build.py {posargs:test} drybell

[testenv:recsys]
description = build recsys notebook
commands = python {toxinidir}/scripts/build.py {posargs:test} recsys

[testenv:style]
description = check the code style
commands =
    black --check {toxinidir}
    flake8 {toxinidir}

[testenv:fix]
description = run code stylers
commands = black {toxinidir}
